ddp:
  rank_start: 0
  ddp_enable: True
  world_size: 4
  gpus: [0,1,2,3]
  
model:
  train_model: "survf_fusion"
  num_layers: 18
  weights_init: True

  #ablation - choose between fusion model(fusion) and baseline model(fsm)
  depth_model: 'fusion'
  pose_model: 'fusion'
  
  # Pose & depth share same encoder structure
  fusion_level: 2
  fusion_feat_in_dim: 256
  use_skips: False
  
  # define the 3D voxel space
  voxel_unit_size: [1.0, 1.0, 1.5] # size of unit voxel in (m), [x, y, z]
  voxel_size: [100, 100, 20] # num of voxels in each dimension. [x, y, z]
  voxel_str_p: [-50.0, -50.0, -15.0] # voxel start point [x, y, z]
  voxel_pre_dim: [64]
  proj_d_bins: 50
  proj_d_str: 2
  proj_d_end: 50

  with_gt: False


data:
#  data_path: './data/DDAD/ddad.json'
  data_path: './data/DDAD/ddad.json'
#  data_path: './data/DDAD/ddad.json'
  # 改这个确定存储的model位置
  log_dir: './results_ab/sur_vf_fusion_time_9_gt/'
  dataset: 'ddad'
  back_context: 1
  forward_context: 1
  depth_type: 'lidar'
  cameras: ['camera_01', 'camera_05', 'camera_06', 'camera_07', 'camera_08', 'camera_09']
  train_requirements: (gt_pose, gt_depth, mask)
  val_requirements: (gt_pose, gt_depth, mask)

training:
  # Basic
  height: 384
  width: 640
  scales: [0] 
  frame_ids: [0, -1, 1]
  
  # optimization
  batch_size: 1
  num_workers: 8
  learning_rate: 0.00005
  num_epochs: 20
  scheduler_step_size: 15

  # model / loss setting
  ## depth range
  min_depth: 1.5
  max_depth: 200.0

  ## spatio & temporal
  spatio: True
  spatio_temporal: True

  ## intensity align
  intensity_align: True
  
  ## focal length scaling
  focal_length_scale: 300

  ## depth synthesis
  aug_depth: False
  aug_angle: [15, 15, 40] # 15deg(roll), 15deg(pitch), 40deg(yaw) augmentation

  iter_num: [8, 8, 8, 8, 8]

# Loss hyperparams
loss:
  disparity_smoothness: 0.001
  spatio_coeff: 0.03
  spatio_tempo_coeff: 0.1
  pose_loss_coeff: 0.0
  sys_coeff: 0.01
  
eval:
  eval_batch_size: 1
  eval_num_workers: 8
  eval_min_depth: 0.5
  eval_max_depth: 200
  eval_visualize: False
  syn_visualize: False
  syn_idx: 245
  
load:
  pretrain: True
  weights: 'weights_19'
  # 当亲最佳
#  load_weights_dir: './results_ab/sur_vf_fusion_time_5/survf_fusion/models/weights_7e_112b'
#  metric | abs_rel:
#    0.224 | sq_rel:
#      7.657 | rms:
#        12.812 | log_rms:
#          0.317 | a1:
#            0.765 | a2:
#              0.899 | a3: 0.943
#  median | abs_rel:
#    0.219 | sq_rel:
#      6.237 | rms:
#        12.626 | log_rms:
#          0.311 | a1:
#            0.755 | a2:
#              0.898 | a3: 0.945


  #  load_weights_dir: './results_ab/sur_vf_fusion_time_9_gt/survf_fusion/models/weights_0e_199b'
#  metric | abs_rel:
#    0.185 | sq_rel:
#      2.988 | rms:
#        11.452 | log_rms:
#          0.281 | a1:
#            0.782 | a2:
#              0.916 | a3: 0.956
#  median | abs_rel:
#    0.173 | sq_rel:
#      2.850 | rms:
#        11.676 | log_rms:
#          0.278 | a1:
#            0.791 | a2:
#              0.914 | a3: 0.955





#  #  load_weights_dir: './results_ab/sur_vf_fusion_time_9_gt/survf_fusion/models/weights_0e_299b'
#  metric | abs_rel:
#    0.180 | sq_rel:
#      2.871 | rms:
#        11.289 | log_rms:
#          0.280 | a1:
#            0.786 | a2:
#              0.916 | a3: 0.956
#  median | abs_rel:
#    0.175 | sq_rel:
#      2.810 | rms:
#        11.437 | log_rms:
#          0.277 | a1:
#            0.786 | a2:
#              0.915 | a3: 0.956




#  load_weights_dir: './results_ab/sur_vf_fusion_time_9_gt/survf_fusion/models/weights_0e_699b'

#   metric | abs_rel: 0.166 | sq_rel: 2.613 | rms: 10.952 | log_rms: 0.271 | a1: 0.800 | a2: 0.921 | a3: 0.959
#   median | abs_rel: 0.170 | sq_rel: 2.666 | rms: 11.083 | log_rms: 0.269 | a1: 0.795 | a2: 0.920 | a3: 0.959
#


#  load_weights_dir: './results_ab/sur_vf_fusion_time_10_gt/survf_fusion/models/weights_0e_34b'
#metric | abs_rel: 0.236 | sq_rel: 3.930 | rms: 12.119 | log_rms: 0.313 | a1: 0.678 | a2: 0.897 | a3: 0.952
#   median | abs_rel: 0.197 | sq_rel: 3.266 | rms: 11.928 | log_rms: 0.297 | a1: 0.743 | a2: 0.904 | a3: 0.951



#  load_weights_dir: './results_ab/sur_vf_fusion_time_10_gt/survf_fusion/models/weights_0e_69b'

#   metric | abs_rel: 0.234 | sq_rel: 3.925 | rms: 12.119 | log_rms: 0.313 | a1: 0.680 | a2: 0.897 | a3: 0.952
#   median | abs_rel: 0.198 | sq_rel: 3.283 | rms: 11.932 | log_rms: 0.297 | a1: 0.741 | a2: 0.903 | a3: 0.951
#metric:  defaultdict(<class 'float'>, {'abs_rel': 0.23417210679033568, 'sq_rel': 3.924626821996842, 'rms': 12.118652765100626, 'log_rms': 0.31275549637032746, 'a1': 0.6799537328104952, 'a2': 0.8973969395542525, 'a3': 0.9517695647813533})
#median  defaultdict(<class 'float'>, {'abs_rel': 0.1979842049657524, 'sq_rel': 3.2826042655226457, 'rms': 11.931609147059465, 'log_rms': 0.29725095557702125, 'a1': 0.7414432572750832, 'a2': 0.9034972410594224, 'a3': 0.950759232983445})
#metric-0:  {'abs_rel': 0.17863856694334512, 'sq_rel': 3.5888353711057017, 'rms': 13.481999538595026, 'log_rms': 0.2400298275537305, 'a1': 0.7707889699471462, 'a2': 0.9384388299112196, 'a3': 0.9778662968455971}
#median-0:  {'abs_rel': 0.150301895392212, 'sq_rel': 2.637096741632982, 'rms': 12.549399029744135, 'log_rms': 0.22474330848881177, 'a1': 0.8190041451059379, 'a2': 0.9511451316963543, 'a3': 0.9793784430739167}
#metric-1:  {'abs_rel': 0.2295255890285427, 'sq_rel': 3.374706905015877, 'rms': 11.37425619769406, 'log_rms': 0.30617286481640554, 'a1': 0.6882202772776802, 'a2': 0.9034004466719442, 'a3': 0.9553494914630791}
#median-1:  {'abs_rel': 0.19434271188718932, 'sq_rel': 2.826616935525815, 'rms': 11.45894972429647, 'log_rms': 0.2944629020069714, 'a1': 0.7458853993419703, 'a2': 0.9073885735288842, 'a3': 0.9530144149993921}
#metric-2:  {'abs_rel': 0.25270805889135833, 'sq_rel': 4.588550870531758, 'rms': 11.351705272569285, 'log_rms': 0.3383005203925944, 'a1': 0.6814662849206429, 'a2': 0.8813185793471027, 'a3': 0.9387030193712804}
#median-2:  {'abs_rel': 0.22266360129822385, 'sq_rel': 3.785254468079898, 'rms': 11.121697039867376, 'log_rms': 0.32294118361813684, 'a1': 0.7064861695139439, 'a2': 0.8847639608866983, 'a3': 0.9414700892761156}
#metric-3:  {'abs_rel': 0.26141939514159385, 'sq_rel': 3.845678727154608, 'rms': 11.517253389606228, 'log_rms': 0.33336881600610624, 'a1': 0.6249883003977986, 'a2': 0.8838974405109108, 'a3': 0.9445144082741304}
#median-3:  {'abs_rel': 0.20407334163978502, 'sq_rel': 3.184267929830141, 'rms': 11.327796084292522, 'log_rms': 0.3086076710963404, 'a1': 0.7357029809831799, 'a2': 0.8910670939881307, 'a3': 0.9433824417072457}
#metric-4:  {'abs_rel': 0.2513780592478715, 'sq_rel': 4.19554167560459, 'rms': 10.98955093105118, 'log_rms': 0.3480808365906214, 'a1': 0.6628052766969451, 'a2': 0.8820583822084712, 'a3': 0.9369114273709136}
#median-4:  {'abs_rel': 0.23039338263017792, 'sq_rel': 4.159657742955855, 'rms': 11.241543371863179, 'log_rms': 0.336641690384645, 'a1': 0.7086648300614257, 'a2': 0.8777273088858112, 'a3': 0.9309633951411619}
#metric-5:  {'abs_rel': 0.23136297222855803, 'sq_rel': 3.954447359852977, 'rms': 13.997151244274981, 'log_rms': 0.3105801126786641, 'a1': 0.6514532924704738, 'a2': 0.8952679609478295, 'a3': 0.9572727529878741}
#median-5:  {'abs_rel': 0.1861302954790654, 'sq_rel': 3.102731744174833, 'rms': 13.890269574313969, 'log_rms': 0.29610897994273666, 'a1': 0.7329160181500695, 'a2': 0.9088913738882387, 'a3': 0.9563466151039322}


#  load_weights_dir: './results_ab/sur_vf_fusion_time_10_gt/survf_fusion/models/weights_0e_104b'
#   metric | abs_rel: 0.182 | sq_rel: 3.147 | rms: 12.718 | log_rms: 0.298 | a1: 0.768 | a2: 0.898 | a3: 0.945
#   median | abs_rel: 0.180 | sq_rel: 3.147 | rms: 12.704 | log_rms: 0appeal.293 | a1: 0.768 | a2: 0.899 | a3: 0.947
#   metric | abs_rel: 0.193 | sq_rel: 3.083 | rms: 11.724 | log_rms: 0.291 | a1: 0.758 | a2: 0.905 | a3: 0.953
#   median | abs_rel: 0.185 | sq_rel: 3.001 | rms: 11.973 | log_rms: 0.289 | a1: 0.764 | a2: 0.904 | a3: 0.951
#metric:  defaultdict(<class 'float'>, {'abs_rel': 0.19301188253737064, 'sq_rel': 3.0831425682497273, 'rms': 11.723804567015003, 'log_rms': 0.29090361052519276, 'a1': 0.757902789188157, 'a2': 0.9046915430011159, 'a3': 0.9529797788925513})
#median  defaultdict(<class 'float'>, {'abs_rel': 0.18537792163493808, 'sq_rel': 3.000603127882076, 'rms': 11.973351331686073, 'log_rms': 0.2894390230313009, 'a1': 0.7636423192447396, 'a2': 0.9038818507999561, 'a3': 0.9514890750868494})
#metric-0:  {'abs_rel': 0.1311316076308102, 'sq_rel': 2.512275577977106, 'rms': 12.716272465594404, 'log_rms': 0.21426544355301114, 'a1': 0.8454986133900556, 'a2': 0.9495256673980069, 'a3': 0.9788549715822393}
#median-0:  {'abs_rel': 0.12683633977232817, 'sq_rel': 2.3726151405313574, 'rms': 12.806433954176965, 'log_rms': 0.21364864386811658, 'a1': 0.8497537406040476, 'a2': 0.9490566724461394, 'a3': 0.9783750916146613}
#metric-1:  {'abs_rel': 0.1924067822805086, 'sq_rel': 2.812252819833237, 'rms': 11.180675625057964, 'log_rms': 0.2868712613131706, 'a1': 0.7598665557511441, 'a2': 0.9061975228012382, 'a3': 0.955158838776799}
#median-1:  {'abs_rel': 0.18532249132534126, 'sq_rel': 2.717962975700374, 'rms': 11.44616833134131, 'log_rms': 0.2870228917054929, 'a1': 0.7628217415540637, 'a2': 0.9077246797471852, 'a3': 0.9541443088921634}
#metric-2:  {'abs_rel': 0.208164242526347, 'sq_rel': 3.407870233056994, 'rms': 11.04464961689788, 'log_rms': 0.3179121786181803, 'a1': 0.7482253787192431, 'a2': 0.8880438437554743, 'a3': 0.9394549580827936}
#median-2:  {'abs_rel': 0.20984845301934651, 'sq_rel': 3.2923305869114574, 'rms': 11.087226216375054, 'log_rms': 0.3141086425341956, 'a1': 0.7327444108449793, 'a2': 0.8864516970186265, 'a3': 0.9430195114597097}
#metric-3:  {'abs_rel': 0.21182811085183126, 'sq_rel': 3.0375778188488702, 'rms': 11.039595561197826, 'log_rms': 0.3059576166411499, 'a1': 0.7275685457865914, 'a2': 0.8927234573255886, 'a3': 0.948434800064409}
#median-3:  {'abs_rel': 0.19138414901185347, 'sq_rel': 2.8377924111766086, 'rms': 11.30118190407753, 'log_rms': 0.3002067042877535, 'a1': 0.7540977321429686, 'a2': 0.8952418728346948, 'a3': 0.9475379090649741}
#metric-4:  {'abs_rel': 0.2189803272621198, 'sq_rel': 3.330882566464799, 'rms': 10.622362280124193, 'log_rms': 0.3294177148616933, 'a1': 0.7296686754133794, 'a2': 0.8887853175169462, 'a3': 0.9381452439899568}
#median-4:  {'abs_rel': 0.22189615019246356, 'sq_rel': 3.6780215926332906, 'rms': 11.14370534632113, 'log_rms': 0.33136152007363057, 'a1': 0.7252134198821211, 'a2': 0.8778223968984245, 'a3': 0.9305622330462778}
#metric-5:  {'abs_rel': 0.19556022467357773, 'sq_rel': 3.397996388395111, 'rms': 13.73927181912707, 'log_rms': 0.29099744694186497, 'a1': 0.7365889686810506, 'a2': 0.9028734501925382, 'a3': 0.9578298602011297}
#median-5:  {'abs_rel': 0.17697994629284003, 'sq_rel': 3.1048960622874175, 'rms': 14.05539234297616, 'log_rms': 0.2902857370887484, 'a1': 0.7572228698606615, 'a2': 0.9069937920880008, 'a3': 0.9552953962846236}

#  load_weights_dir: './results_ab/sur_vf_fusion_time_11/survf_fusion/models/weights_2e_2197b'
#metric:  defaultdict(<class 'float'>, {'abs_rel': 0.21201583611500724, 'sq_rel': 7.7722986055813985, 'rms': 13.204771200650697, 'log_rms': 0.32044470058891233, 'a1': 0.7615851583367313, 'a2': 0.8919442032322736, 'a3': 0.9384140052320633})
#median  defaultdict(<class 'float'>, {'abs_rel': 0.2058322402667174, 'sq_rel': 5.370686663611102, 'rms': 12.548868022192067, 'log_rms': 0.3032398370643708, 'a1': 0.7671103959372537, 'a2': 0.8985233400807245, 'a3': 0.9438994742884776})
#metric-0:  {'abs_rel': 0.19230249991567877, 'sq_rel': 10.761266575865932, 'rms': 14.682352812754644, 'log_rms': 0.2529385077024435, 'a1': 0.8262294901733275, 'a2': 0.9314903788520145, 'a3': 0.9642451423329192}
#median-0:  {'abs_rel': 0.16926393473399923, 'sq_rel': 5.7455821180730675, 'rms': 13.983496988593759, 'log_rms': 0.24306110621079222, 'a1': 0.8309566517251653, 'a2': 0.9301910957045756, 'a3': 0.9645628169372484}
#metric-1:  {'abs_rel': 0.19598410980171196, 'sq_rel': 6.6815615714680066, 'rms': 12.405144529559395, 'log_rms': 0.3092732284479327, 'a1': 0.7634636565849379, 'a2': 0.8969781090532031, 'a3': 0.9443621976809068}
#median-1:  {'abs_rel': 0.19441351900143283, 'sq_rel': 5.187667163689802, 'rms': 11.858176970032902, 'log_rms': 0.29295795002540986, 'a1': 0.7776605268867759, 'a2': 0.9083638258916991, 'a3': 0.9519094703878676}
#metric-2:  {'abs_rel': 0.1943135732001105, 'sq_rel': 3.5781102721010902, 'rms': 11.64216052505877, 'log_rms': 0.330162307135277, 'a1': 0.7548686223486801, 'a2': 0.8884298953684894, 'a3': 0.9362092359035046}
#median-2:  {'abs_rel': 0.20271770679476586, 'sq_rel': 3.4952850550875163, 'rms': 11.281936050994055, 'log_rms': 0.3129900092002633, 'a1': 0.7498139320420367, 'a2': 0.8951886826947137, 'a3': 0.9403222234063334}
#metric-3:  {'abs_rel': 0.2464165276632487, 'sq_rel': 9.916048661731184, 'rms': 13.017539260186158, 'log_rms': 0.34498407993320523, 'a1': 0.7380688490650871, 'a2': 0.8733240795638654, 'a3': 0.9256162963130258}
#median-3:  {'abs_rel': 0.23120070837776768, 'sq_rel': 7.29403480186623, 'rms': 12.024904214600465, 'log_rms': 0.31986783581991474, 'a1': 0.7528241146343773, 'a2': 0.8858377988510705, 'a3': 0.9372506875148067}
#metric-4:  {'abs_rel': 0.19585489025653957, 'sq_rel': 3.3595983737368473, 'rms': 10.847474396646797, 'log_rms': 0.33994558466912866, 'a1': 0.7482803430243746, 'a2': 0.8844239525825947, 'a3': 0.9307611502571539}
#median-4:  {'abs_rel': 0.21289228683942324, 'sq_rel': 3.7253813680725827, 'rms': 10.66106556731385, 'log_rms': 0.3236722629236711, 'a1': 0.7533371763139383, 'a2': 0.8851843181291184, 'a3': 0.931412644659157}
#metric-5:  {'abs_rel': 0.24722341728094335, 'sq_rel': 12.33720628492244, 'rms': 16.63395574551124, 'log_rms': 0.3453644927175014, 'a1': 0.7385999858572886, 'a2': 0.8770187974130953, 'a3': 0.9292900111768153}
#median-5:  {'abs_rel': 0.22450528301975944, 'sq_rel': 6.776169536763971, 'rms': 15.483628366334099, 'log_rms': 0.3268898554378516, 'a1': 0.7380699721307723, 'a2': 0.8863743158362128, 'a3': 0.9379390009734537}

#  load_weights_dir: './results_ab/sur_vf_fusion_time_11/survf_fusion/models/weights_0e_2399b'
#metric:  defaultdict(<class 'float'>, {'abs_rel': 0.2508065416338126, 'sq_rel': 11.634016283951805, 'rms': 12.649251186073615, 'log_rms': 0.3091727442942657, 'a1': 0.7812235498325131, 'a2': 0.9076444675912088, 'a3': 0.9483097894676857})
#median  defaultdict(<class 'float'>, {'abs_rel': 0.221957769134602, 'sq_rel': 7.201912503247659, 'rms': 12.288090667229177, 'log_rms': 0.3029757682611421, 'a1': 0.7756546123822533, 'a2': 0.9035337872629048, 'a3': 0.9461857738226535})
#metric-0:  {'abs_rel': 0.22962209747983264, 'sq_rel': 15.076140197051036, 'rms': 13.970782746711334, 'log_rms': 0.24901483928421875, 'a1': 0.8359091545157619, 'a2': 0.9433160061805279, 'a3': 0.9693154503927602}
#median-0:  {'abs_rel': 0.1866103202510964, 'sq_rel': 7.484189227227267, 'rms': 13.56212858593309, 'log_rms': 0.24115327441073084, 'a1': 0.838049157800806, 'a2': 0.9373386120970373, 'a3': 0.9674200624691975}
#metric-1:  {'abs_rel': 0.2167802461081898, 'sq_rel': 8.201335745145167, 'rms': 11.5028292856588, 'log_rms': 0.2901617471951169, 'a1': 0.7934284939433073, 'a2': 0.9135061614931403, 'a3': 0.9552854605619009}
#median-1:  {'abs_rel': 0.2056910498856337, 'sq_rel': 6.5139680320546995, 'rms': 11.485573053390949, 'log_rms': 0.2888252964886752, 'a1': 0.7879513996418613, 'a2': 0.9142776466073927, 'a3': 0.9550175377223399}
#metric-2:  {'abs_rel': 0.2370771501445538, 'sq_rel': 6.676843421530317, 'rms': 11.646031847480055, 'log_rms': 0.32413512943530237, 'a1': 0.7761116595701738, 'a2': 0.9005736947369266, 'a3': 0.9422915244876564}
#median-2:  {'abs_rel': 0.22353882622118895, 'sq_rel': 5.575366368479543, 'rms': 11.528552550340628, 'log_rms': 0.319553376252388, 'a1': 0.7525454625380891, 'a2': 0.892536180094852, 'a3': 0.9402886818639644}
#metric-3:  {'abs_rel': 0.2925364054613686, 'sq_rel': 15.954671617471552, 'rms': 12.601514642795959, 'log_rms': 0.33007900368180365, 'a1': 0.7607190422926631, 'a2': 0.8925580007573227, 'a3': 0.94051526911847}
#median-3:  {'abs_rel': 0.2566402045255164, 'sq_rel': 11.588100700725306, 'rms': 11.96269681320562, 'log_rms': 0.3200512986901132, 'a1': 0.7650229020830389, 'a2': 0.8913394745729574, 'a3': 0.9394183224284803}
#metric-4:  {'abs_rel': 0.22999733469896502, 'sq_rel': 5.665123767858589, 'rms': 10.665297998840158, 'log_rms': 0.3304100166977226, 'a1': 0.7657839530009728, 'a2': 0.8979775936417765, 'a3': 0.939024386165978}
#median-4:  {'abs_rel': 0.22684085186135458, 'sq_rel': 5.194997148577656, 'rms': 10.681674791450625, 'log_rms': 0.3260668260594467, 'a1': 0.760655019512134, 'a2': 0.891131168993843, 'a3': 0.9350005404457643}
#metric-5:  {'abs_rel': 0.29882601458143876, 'sq_rel': 18.229983027159392, 'rms': 15.509050500238097, 'log_rms': 0.33123572904568216, 'a1': 0.7553889934350918, 'a2': 0.8979353456915199, 'a3': 0.9434266565682052}
#median-5:  {'abs_rel': 0.2324253622935964, 'sq_rel': 6.8548536684451165, 'rms': 14.507918253502288, 'log_rms': 0.3222045400371025, 'a1': 0.7497037403295179, 'a2': 0.8945796421073474, 'a3': 0.9399695012108846}

#  load_weights_dir: './results_ab/sur_vf_fusion_time_11/survf_fusion/models/weights_1e_3398b'
#metric:  defaultdict(<class 'float'>, {'abs_rel': 0.26287172778860374, 'sq_rel': 12.116872858232222, 'rms': 13.28905677622015, 'log_rms': 0.32427875976799847, 'a1': 0.7697466532905378, 'a2': 0.9015262851054514, 'a3': 0.9421613796964868})
#median  defaultdict(<class 'float'>, {'abs_rel': 0.2303164576593925, 'sq_rel': 6.937715169810632, 'rms': 12.680367302750094, 'log_rms': 0.31388594544037146, 'a1': 0.7615904437747321, 'a2': 0.8955156758440525, 'a3': 0.9416183887312425})
#metric-0:  {'abs_rel': 0.2311497223919088, 'sq_rel': 15.65531010290632, 'rms': 14.300597713272293, 'log_rms': 0.25412874725538415, 'a1': 0.8370612961440892, 'a2': 0.9388629890571941, 'a3': 0.965809600631912}
#median-0:  {'abs_rel': 0.19311164382022697, 'sq_rel': 7.520305748856687, 'rms': 13.896986064446438, 'log_rms': 0.24816050089798963, 'a1': 0.8276379111960723, 'a2': 0.9311484663188457, 'a3': 0.9630882253004359}
#metric-1:  {'abs_rel': 0.22856853592608656, 'sq_rel': 9.104532472218398, 'rms': 11.924168530160731, 'log_rms': 0.3014588088339025, 'a1': 0.7836979134284057, 'a2': 0.90957971904959, 'a3': 0.9508206208185717}
#median-1:  {'abs_rel': 0.2128988213111441, 'sq_rel': 6.048949880859294, 'rms': 11.757974175354104, 'log_rms': 0.29760660189506294, 'a1': 0.7776192639506869, 'a2': 0.9089720204743472, 'a3': 0.95147309862174}
#metric-2:  {'abs_rel': 0.23578158899851434, 'sq_rel': 6.320300825344665, 'rms': 11.443813377510418, 'log_rms': 0.33051005762022034, 'a1': 0.7672222343048491, 'a2': 0.8999593243041596, 'a3': 0.941012121779578}
#median-2:  {'abs_rel': 0.22630364347878215, 'sq_rel': 5.470205641755133, 'rms': 11.451582485654137, 'log_rms': 0.3227053629829512, 'a1': 0.7468296655610978, 'a2': 0.894267139161949, 'a3': 0.9397790827611824}
#metric-3:  {'abs_rel': 0.3113775096369254, 'sq_rel': 15.318789135715017, 'rms': 13.642411467611016, 'log_rms': 0.3516626115143299, 'a1': 0.7449293273029389, 'a2': 0.8839738199230912, 'a3': 0.9299928527605998}
#median-3:  {'abs_rel': 0.2562633336093519, 'sq_rel': 8.554352509945437, 'rms': 12.369690785779582, 'log_rms': 0.3331972004695759, 'a1': 0.7442478219509222, 'a2': 0.8746585845773096, 'a3': 0.930019763388804}
#metric-4:  {'abs_rel': 0.24275590443282158, 'sq_rel': 6.154366472761159, 'rms': 11.114966091227222, 'log_rms': 0.3480608103317874, 'a1': 0.7445576271172855, 'a2': 0.8902196617211614, 'a3': 0.933195241097506}
#median-4:  {'abs_rel': 0.23500936756853932, 'sq_rel': 5.648647272752283, 'rms': 10.940976706867094, 'log_rms': 0.33632273574928184, 'a1': 0.7475481507303072, 'a2': 0.8887101277592895, 'a3': 0.9350734215026552}
#metric-5:  {'abs_rel': 0.32759710692159544, 'sq_rel': 20.147938102081223, 'rms': 17.308383476765126, 'log_rms': 0.35985152537172493, 'a1': 0.741011515073962, 'a2': 0.8865621957531223, 'a3': 0.9321378377660529}
#median-5:  {'abs_rel': 0.2583119338731487, 'sq_rel': 8.383829938281666, 'rms': 15.664993533716574, 'log_rms': 0.3453232714920849, 'a1': 0.7256598424379315, 'a2': 0.8753377185026546, 'a3': 0.9302767466531171}



# 这个是icme消融实验
#  load_weights_dir: './results_ab/sur_vf_fusion_time_11/survf_fusion/models/weights_2e_2997b'
#metric:  defaultdict(<class 'float'>, {'abs_rel': 0.2348220668584756, 'sq_rel': 9.49112035811722, 'rms': 12.870604209239337, 'log_rms': 0.3211094144825304, 'a1': 0.7745781513313175, 'a2': 0.8989105313990545, 'a3': 0.9407328340811146})
#median  defaultdict(<class 'float'>, {'abs_rel': 0.22012654957704192, 'sq_rel': 6.693732463095612, 'rms': 12.59619296334009, 'log_rms': 0.3118439783007549, 'a1': 0.7631770636612225, 'a2': 0.8932204687337348, 'a3': 0.9408661871967888})
#metric-0:  {'abs_rel': 0.21399102297212397, 'sq_rel': 12.617879847868696, 'rms': 14.282039598180102, 'log_rms': 0.2564074181678233, 'a1': 0.8338241055801318, 'a2': 0.9351914455364276, 'a3': 0.9642620117943008}
#median-0:  {'abs_rel': 0.1823425797073098, 'sq_rel': 6.545814137009831, 'rms': 14.041001217953571, 'log_rms': 0.25174261058112246, 'a1': 0.8235467777464104, 'a2': 0.926871852346442, 'a3': 0.9613900183083175}
#metric-1:  {'abs_rel': 0.2012776888461856, 'sq_rel': 7.227327105594533, 'rms': 11.70304940019335, 'log_rms': 0.3010200927435578, 'a1': 0.7858336356475756, 'a2': 0.9057658377328477, 'a3': 0.9494991114232447}
#median-1:  {'abs_rel': 0.2043257390320688, 'sq_rel': 6.674138523214436, 'rms': 11.713574374527127, 'log_rms': 0.29627355710833103, 'a1': 0.7804591511286698, 'a2': 0.908858995948519, 'a3': 0.9515467643970019}
#metric-2:  {'abs_rel': 0.21474770044448313, 'sq_rel': 4.87154280410378, 'rms': 11.179117110681224, 'log_rms': 0.32865786777107747, 'a1': 0.7752159708273876, 'a2': 0.8969427818446964, 'a3': 0.9386293057652263}
#median-2:  {'abs_rel': 0.21608045196281625, 'sq_rel': 4.548325391155849, 'rms': 11.354587958602162, 'log_rms': 0.32039391042446935, 'a1': 0.7445391576381569, 'a2': 0.8879218158280695, 'a3': 0.9381927633324226}
#metric-3:  {'abs_rel': 0.2676559416344994, 'sq_rel': 10.79907451893457, 'rms': 12.769721582307444, 'log_rms': 0.3453698332356168, 'a1': 0.748371370173507, 'a2': 0.8790162010819881, 'a3': 0.9271318554491191}
#median-3:  {'abs_rel': 0.24283314485586696, 'sq_rel': 9.018269293207142, 'rms': 12.044195376433334, 'log_rms': 0.32933963995862314, 'a1': 0.749767429988541, 'a2': 0.8748495773622742, 'a3': 0.9304629250819033}
#metric-4:  {'abs_rel': 0.20869039650571036, 'sq_rel': 4.327339957810261, 'rms': 10.52032978009868, 'log_rms': 0.33723793131771024, 'a1': 0.7629126967625185, 'a2': 0.8941516407046999, 'a3': 0.9354259904096653}
#median-4:  {'abs_rel': 0.2216783247747785, 'sq_rel': 4.7485464335939325, 'rms': 10.735298874471095, 'log_rms': 0.32823223348368297, 'a1': 0.7602161196355599, 'a2': 0.8879912330587576, 'a3': 0.9319118051598598}
#metric-5:  {'abs_rel': 0.3025696507754264, 'sq_rel': 17.103557991873135, 'rms': 16.769367823538843, 'log_rms': 0.3579633424827805, 'a1': 0.7413111271409245, 'a2': 0.8823952797248766, 'a3': 0.9294487255424648}
#median-5:  {'abs_rel': 0.25349905770320397, 'sq_rel': 8.627300940906848, 'rms': 15.68849985816262, 'log_rms': 0.3450819169081651, 'a1': 0.7205337447818223, 'a2': 0.8728293444525886, 'a3': 0.9316928514141541}


# 以下是消融实验部分
  # （1）#  load_weights_dir: './results_ab/viv/vic_vf_fusion_time_3/survf_fusion/models/weights_6e_1993b'
  ##   metric | abs_rel: 0.175 | sq_rel: 2.858 | rms: 10.887 | log_rms: 0.275 | a1: 0.787 | a2: 0.918 | a3: 0.958
  ##   median | abs_rel: 0.177 | sq_rel: 2.894 | rms: 10.869 | log_rms: 0.271 | a1: 0.788 | a2: 0.920 | a3: 0.959
  ## 这个是训练了20 epoch的full

  # epoch 5
  # 这个是消融实验
#  load_weights_dir: './results_ab/sur_vf_fusion_time_5/survf_fusion/models/weights_2e_317b'
#   metric | abs_rel: 0.209 | sq_rel: 6.472 | rms: 12.876 | log_rms: 0.315 | a1: 0.770 | a2: 0.897 | a3: 0.942
#   median | abs_rel: 0.204 | sq_rel: 5.288 | rms: 12.673 | log_rms: 0.308 | a1: 0.764 | a2: 0.897 | a3: 0.944
#metric:  defaultdict(<class 'float'>, {'abs_rel': 0.20906382395075496, 'sq_rel': 6.472355211524207, 'rms': 12.876239977667346, 'log_rms': 0.3154590477313839, 'a1': 0.7703528653285179, 'a2': 0.897465476040199, 'a3': 0.9419572151481344})
#median  defaultdict(<class 'float'>, {'abs_rel': 0.2042813790218657, 'sq_rel': 5.288269505480156, 'rms': 12.672760789466626, 'log_rms': 0.3077165627763381, 'a1': 0.7640572390024805, 'a2': 0.8971952588424016, 'a3': 0.9444913356231918})
#metric-0:  {'abs_rel': 0.17633703631820616, 'sq_rel': 7.523345636191306, 'rms': 14.688285679445638, 'log_rms': 0.25260849817426173, 'a1': 0.8260859821369122, 'a2': 0.9327039672956838, 'a3': 0.9658404730357133}
#median-0:  {'abs_rel': 0.16499868040251267, 'sq_rel': 5.485336309288229, 'rms': 14.483217998541795, 'log_rms': 0.24959288207741526, 'a1': 0.8233586780920431, 'a2': 0.9290520382062956, 'a3': 0.9657652092599249}
#metric-1:  {'abs_rel': 0.18779628888256364, 'sq_rel': 4.15543259804512, 'rms': 11.928898684452106, 'log_rms': 0.30226742255610306, 'a1': 0.779235816907573, 'a2': 0.9020510048990126, 'a3': 0.9473562838350024}
#median-1:  {'abs_rel': 0.18520129586098255, 'sq_rel': 3.6553918257500833, 'rms': 11.834812455889466, 'log_rms': 0.29632921196810613, 'a1': 0.7770286757266753, 'a2': 0.9057279331324163, 'a3': 0.9496518295074438}
#metric-2:  {'abs_rel': 0.20936425468267558, 'sq_rel': 4.914358878387743, 'rms': 11.357677365541457, 'log_rms': 0.32917052520076173, 'a1': 0.7621298068142557, 'a2': 0.8921718655778216, 'a3': 0.9369442123561711}
#median-2:  {'abs_rel': 0.21673964122431233, 'sq_rel': 4.906894754061065, 'rms': 11.484445813282743, 'log_rms': 0.32214553487475045, 'a1': 0.7400721283319902, 'a2': 0.8859253982077171, 'a3': 0.9383527687888641}
#metric-3:  {'abs_rel': 0.22669071621709055, 'sq_rel': 6.621748015091985, 'rms': 12.161036489071783, 'log_rms': 0.3308781702158513, 'a1': 0.7543024685959537, 'a2': 0.8832995956981337, 'a3': 0.9327666940317525}
#median-3:  {'abs_rel': 0.2135901305195573, 'sq_rel': 5.286084562042704, 'rms': 11.692114466676465, 'log_rms': 0.31780355758868256, 'a1': 0.7547522613686788, 'a2': 0.8877216529362387, 'a3': 0.9396565400702612}
#metric-4:  {'abs_rel': 0.20858354825671618, 'sq_rel': 4.485843065318155, 'rms': 10.676057738375354, 'log_rms': 0.33669129794874747, 'a1': 0.7547324614904144, 'a2': 0.8906851620565761, 'a3': 0.9347314127234669}
#median-4:  {'abs_rel': 0.21991621559606744, 'sq_rel': 4.771853018686563, 'rms': 10.798902958368327, 'log_rms': 0.32896102588768905, 'a1': 0.7490422355223979, 'a2': 0.8869459155540574, 'a3': 0.9324194528356001}
#metric-5:  {'abs_rel': 0.24561110134829175, 'sq_rel': 11.133403105255844, 'rms': 16.445483890880237, 'log_rms': 0.3411383722548361, 'a1': 0.7456306520917199, 'a2': 0.8838812578188908, 'a3': 0.9341042161607123}
#median-5:  {'abs_rel': 0.22524231121137545, 'sq_rel': 7.62405658167678, 'rms': 15.743070997510637, 'log_rms': 0.33146716373694407, 'a1': 0.7400894509352647, 'a2': 0.8877986183569029, 'a3': 0.9411022080539109}

  # epoch 5 lack-cy
#   load_weights_dir: './results_ab/sur_vf_fusion_time_5/survf_fusion/models/weights_2e_317b'


  # epoch 10 lack-cy
#  load_weights_dir: './results_ab/sur_vf_fusion_time_11/survf_fusion/models/weights_1e_3398b'
#metric:  defaultdict(<class 'float'>, {'abs_rel': 0.26287172778860374, 'sq_rel': 12.116872858232222, 'rms': 13.28905677622015, 'log_rms': 0.32427875976799847, 'a1': 0.7697466532905378, 'a2': 0.9015262851054514, 'a3': 0.9421613796964868})
#median  defaultdict(<class 'float'>, {'abs_rel': 0.2303164576593925, 'sq_rel': 6.937715169810632, 'rms': 12.680367302750094, 'log_rms': 0.31388594544037146, 'a1': 0.7615904437747321, 'a2': 0.8955156758440525, 'a3': 0.9416183887312425})



  # epoch 20 lack-cy
#  load_weights_dir: './results_ab/sur_vf_fusion_time_11/survf_fusion/models/weights_0e_2399b'
#metric:  defaultdict(<class 'float'>, {'abs_rel': 0.2508065416338126, 'sq_rel': 11.634016283951805, 'rms': 12.649251186073615, 'log_rms': 0.3091727442942657, 'a1': 0.7812235498325131, 'a2': 0.9076444675912088, 'a3': 0.9483097894676857})
#median  defaultdict(<class 'float'>, {'abs_rel': 0.221957769134602, 'sq_rel': 7.201912503247659, 'rms': 12.288090667229177, 'log_rms': 0.3029757682611421, 'a1': 0.7756546123822533, 'a2': 0.9035337872629048, 'a3': 0.9461857738226535})

#  load_weights_dir: './results_ab/sur_vf_fusion_time_5/survf_fusion/models/weights_4e_635b'
#  load_weights_dir: './results_ab/sur_vf_fusion_time_11/survf_fusion/models/weights_2e_2197b'
#  load_weights_dir: './results_ab/nusc/sur_vf_fusion_final/survf_fusion_nusc/models/weights_2e_4701b'
#  load_weights_dir: './results_ab/sur_vf_fusion_time_11/survf_fusion/models/weights_2e_2197b'

#  metric-0: { 'abs_rel': 0.1932207872902418, 'sq_rel': 10.789307820804707, 'rms': 14.623771690950765, 'log_rms': 0.25131500410375657, 'a1': 0.8301670260862871, 'a2': 0.9321023482626135, 'a3': 0.9644410350260797 }
#  median-0: { 'abs_rel': 0.1679282408923685, 'sq_rel': 5.545647172813679, 'rms': 14.1234272614702, 'log_rms': 0.24432473903546087, 'a1': 0.8285331006343295, 'a2': 0.9287811410872193, 'a3': 0.9639800888222534 }
#  metric-1: { 'abs_rel': 0.19515962414927296, 'sq_rel': 6.678805322187481, 'rms': 12.366506896111872, 'log_rms': 0.3065278203630602, 'a1': 0.7705612029619031, 'a2': 0.898344666570812, 'a3': 0.944829511363785 }
#  median-1: { 'abs_rel': 0.1944677255989669, 'sq_rel': 4.978607324376315, 'rms': 11.894807642527988, 'log_rms': 0.29418424783201963, 'a1': 0.7759766394364369, 'a2': 0.9076201290085718, 'a3': 0.9514161487523611 }
#  metric-2: { 'abs_rel': 0.19391913475444564, 'sq_rel': 3.573240280544216, 'rms': 11.601428296821458, 'log_rms': 0.32657180489851284, 'a1': 0.7622266730008187, 'a2': 0.8905651734711287, 'a3': 0.9371257256842279 }
#  median-2: { 'abs_rel': 0.2027209913464529, 'sq_rel': 3.4776075577552055, 'rms': 11.323483469981651, 'log_rms': 0.31417606610853177, 'a1': 0.7483370822939006, 'a2': 0.8942848138162842, 'a3': 0.9399830860557494 }
#  metric-3: { 'abs_rel': 0.2461743267315936, 'sq_rel': 9.91978989474185, 'rms': 12.980045609489665, 'log_rms': 0.34235365053566247, 'a1': 0.7433777916644301, 'a2': 0.8748764409376429, 'a3': 0.9262360937022543 }
#  median-3: { 'abs_rel': 0.23015831349344998, 'sq_rel': 6.974342600564146, 'rms': 12.021160323704992, 'log_rms': 0.3203516796376411, 'a1': 0.7515040869739923, 'a2': 0.8855755707428052, 'a3': 0.9369905957773135 }
#  metric-4: { 'abs_rel': 0.19475226572775223, 'sq_rel': 3.354757251468572, 'rms': 10.808561698182837, 'log_rms': 0.3363224710969182, 'a1': 0.7556126310763421, 'a2': 0.8863483343147612, 'a3': 0.9315705605141529 }
#  median-4: { 'abs_rel': 0.21249242813943267, 'sq_rel': 3.696202427457486, 'rms': 10.677510004848628, 'log_rms': 0.3243816179375757, 'a1': 0.7533664488898856, 'a2': 0.8846989226554122, 'a3': 0.9311156476550289 }
#  metric-5: { 'abs_rel': 0.24751771277808524, 'sq_rel': 12.336213134604614, 'rms': 16.602395884216605, 'log_rms': 0.34365670326855274, 'a1': 0.7423515513190976, 'a2': 0.8783209304066447, 'a3': 0.9297283483016027 }
#  median-5: { 'abs_rel': 0.225430776790365, 'sq_rel': 6.697643956712314, 'rms': 15.514931094925124, 'log_rms': 0.3273713986807829, 'a1': 0.7364331535201568, 'a2': 0.8863006428716245, 'a3': 0.9379465536018471 }
#
#


#  load_weights_dir: './results_ab/nusc/sur_vf_fusion_t4_gt/survf_fusion_nusc/models/weights_0e_99b'
#  load_weights_dir: './results_ab/sur_vf_fusion_time_9_gt/survf_fusion/models/weights_0e_299b'
#  load_weights_dir: './results_ab/sur_vf_fusion_time_11/survf_fusion/models/weights_0e_2399b'
#  load_weights_dir: './results_ab/sur_vf_fusion_time_11/survf_fusion/models/weights_1e_3398b'

#  load_weights_dir: './results_ab/sur_vf_fusion_time_9_gt/survf_fusion/models/weights_0e_699b'
#  load_weights_dir: './results_ab/sur_vf_fusion_time_11/survf_fusion/models/weights_1e_3398b'

#  load_weights_dir: './results_ab/sur_vf_fusion_time_10_gt/survf_fusion/models/weights_0e_69b'
#  load_weights_dir: './results_ab/sur_vf_fusion_time_9_gt/survf_fusion/models/weights_0e_699b'

  load_weights_dir: './results_ab/sur_vf_fusion_time_10_gt/survf_fusion/models/weights_0e_104b'
  models_to_load: ['depth_estimation_net','pose_estimation_net']
  
logging:
  early_phase: 2000
  log_frequency: 100
  early_log_frequency: 100
  late_log_frequency: 1000
  save_frequency: 1
  board_pth: './board/M2_sur_vf_fusion_time_7/log'
