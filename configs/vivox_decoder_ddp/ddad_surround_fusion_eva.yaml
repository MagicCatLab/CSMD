ddp:
  rank_start: 0
  ddp_enable: True
  world_size: 4
  gpus: [0,1,3,4]
  
model:
  train_model: "survf_fusion"
  num_layers: 18
  weights_init: True

  #ablation - choose between fusion model(fusion) and baseline model(fsm)
  depth_model: 'fusion'
  pose_model: 'fusion'
  
  # Pose & depth share same encoder structure
  fusion_level: 2
  fusion_feat_in_dim: 256
  use_skips: False
  
  # define the 3D voxel space
  voxel_unit_size: [1.0, 1.0, 1.5] # size of unit voxel in (m), [x, y, z]
  voxel_size: [100, 100, 20] # num of voxels in each dimension. [x, y, z]
  voxel_str_p: [-50.0, -50.0, -15.0] # voxel start point [x, y, z]
  voxel_pre_dim: [64]
  proj_d_bins: 50
  proj_d_str: 2
  proj_d_end: 50

  with_gt: False


data:
  data_path: './data/DDAD/ddad_debug.json'
#  data_path: './data/DDAD/ddad.json'
  # 改这个确定存储的model位置
  log_dir: './results_ab/viv/vic_vf_fusion_time_3/'
  dataset: 'ddad'
  back_context: 1
  forward_context: 1
  depth_type: 'lidar'
  cameras: ['camera_01', 'camera_05', 'camera_06', 'camera_07', 'camera_08', 'camera_09']
  train_requirements: (gt_pose, gt_depth, mask)
  val_requirements: (gt_pose, gt_depth, mask)
  loss_gt: False

training:
  # Basic
  height: 384
  width: 640
  scales: [0] 
  frame_ids: [0, -1, 1]
  
  # optimization
  batch_size: 1
  num_workers: 8
  learning_rate: 0.00005
  num_epochs: 20
  scheduler_step_size: 15

  # model / loss setting
  ## depth range
  min_depth: 1.5
  max_depth: 200.0

  ## spatio & temporal
  spatio: True
  spatio_temporal: True

  ## intensity align
  intensity_align: True
  
  ## focal length scaling
  focal_length_scale: 300

  ## depth synthesis
  aug_depth: False
  aug_angle: [15, 15, 40] # 15deg(roll), 15deg(pitch), 40deg(yaw) augmentation

  iter_num: [8, 8, 8, 8, 8]

# Loss hyperparams
loss:
  disparity_smoothness: 0.001
  spatio_coeff: 0.03
  spatio_tempo_coeff: 0.1
  pose_loss_coeff: 0.0
  sys_coeff: 0.001
  
eval:
  eval_batch_size: 1
  eval_num_workers: 8
  eval_min_depth: 0.5
  eval_max_depth: 200
  eval_visualize: False
  syn_visualize: False
  syn_idx: 245
  
load:
  pretrain: True
  weights: 'weights_19'
#  load_weights_dir: './results_ab/viv/vic_vf_fusion_time_3/survf_fusion/models/weights_6e_1993b'
#   metric | abs_rel: 0.175 | sq_rel: 2.858 | rms: 10.887 | log_rms: 0.275 | a1: 0.787 | a2: 0.918 | a3: 0.958
#   median | abs_rel: 0.177 | sq_rel: 2.894 | rms: 10.869 | log_rms: 0.271 | a1: 0.788 | a2: 0.920 | a3: 0.959
#metric:  defaultdict(<class 'float'>, {'abs_rel': 0.17510123125918511, 'sq_rel': 2.85797228794593, 'rms': 10.886976824756301, 'log_rms': 0.27537668629900225, 'a1': 0.787142281356829, 'a2': 0.9180638599602192, 'a3': 0.9581415772747682})
#median  defaultdict(<class 'float'>, {'abs_rel': 0.1769781592810825, 'sq_rel': 2.894440895339628, 'rms': 10.869330668676477, 'log_rms': 0.2711431103609338, 'a1': 0.7876700095490463, 'a2': 0.9195002027817101, 'a3': 0.9591000682450977})
#metric-0:  {'abs_rel': 0.12761615494629006, 'sq_rel': 2.2430823511736735, 'rms': 11.70991660440123, 'log_rms': 0.2083381859861411, 'a1': 0.8546233689088326, 'a2': 0.9558069007737297, 'a3': 0.9805148210308768}
#median-0:  {'abs_rel': 0.12610885413145864, 'sq_rel': 2.271023384665514, 'rms': 11.539649379036643, 'log_rms': 0.20296633606800785, 'a1': 0.8659129922575765, 'a2': 0.9580212047657409, 'a3': 0.9810845760710828}
#metric-1:  {'abs_rel': 0.17493304449629474, 'sq_rel': 2.675065532423459, 'rms': 10.76279778482078, 'log_rms': 0.27336373605511405, 'a1': 0.7881048000168491, 'a2': 0.9175302429168255, 'a3': 0.9594720230938553}
#median-1:  {'abs_rel': 0.1757515111942957, 'sq_rel': 2.64746729693436, 'rms': 10.792728180389899, 'log_rms': 0.2728513302683056, 'a1': 0.781542837655583, 'a2': 0.9179971851543947, 'a3': 0.959494188714337}
#metric-2:  {'abs_rel': 0.19114125378623412, 'sq_rel': 3.0409433194104727, 'rms': 10.028216427595584, 'log_rms': 0.29512429050036837, 'a1': 0.7701876198935819, 'a2': 0.9091933129514966, 'a3': 0.9513575764445515}
#median-2:  {'abs_rel': 0.1971838285822373, 'sq_rel': 3.0661408919357247, 'rms': 10.065463006124869, 'log_rms': 0.2926156225568288, 'a1': 0.7599331892736546, 'a2': 0.9090338121064298, 'a3': 0.9526602123774491}
#metric-3:  {'abs_rel': 0.18658921626481142, 'sq_rel': 2.828200886459513, 'rms': 10.466054516736563, 'log_rms': 0.28841728418484913, 'a1': 0.7696587284741464, 'a2': 0.908102637653227, 'a3': 0.9534895551978768}
#median-3:  {'abs_rel': 0.18475082308441013, 'sq_rel': 2.826698451980755, 'rms': 10.413850405912894, 'log_rms': 0.28442711193840226, 'a1': 0.7720749726968926, 'a2': 0.9097880809841218, 'a3': 0.9540608378509422}
#metric-4:  {'abs_rel': 0.21019741430104552, 'sq_rel': 3.427905136919641, 'rms': 9.985372633175416, 'log_rms': 0.3209847494785662, 'a1': 0.7404022843729366, 'a2': 0.8935491909918847, 'a3': 0.9413617577490868}
#median-4:  {'abs_rel': 0.21325536049902438, 'sq_rel': 3.5490058253628094, 'rms': 10.025676077124361, 'log_rms': 0.3115549437585589, 'a1': 0.7475120496643441, 'a2': 0.8947042264508737, 'a3': 0.9427078470684491}
#metric-5:  {'abs_rel': 0.16013030261672162, 'sq_rel': 2.932636476012019, 'rms': 12.369502861468822, 'log_rms': 0.2660318706116893, 'a1': 0.7998768901050864, 'a2': 0.9242008743038426, 'a3': 0.9626537299001372}
#median-5:  {'abs_rel': 0.16481857853953716, 'sq_rel': 3.006309520869286, 'rms': 12.378616982187543, 'log_rms': 0.262443315806714, 'a1': 0.7990440201798042, 'a2': 0.9274567113603864, 'a3': 0.964592750985901}
#  load_weights_dir: './results_ab/viv/vic_vf_fusion_time_3/survf_fusion/models/weights_5e_3994b'
#metric:  defaultdict(<class 'float'>, {'abs_rel': 0.18172108010683194, 'sq_rel': 2.6848103903537197, 'rms': 10.808325957591409, 'log_rms': 0.2741810760069721, 'a1': 0.7785305815238485, 'a2': 0.9163198617216818, 'a3': 0.9579483273122217})
#median  defaultdict(<class 'float'>, {'abs_rel': 0.17617545003369753, 'sq_rel': 2.6167154423653844, 'rms': 10.889308052475828, 'log_rms': 0.2705718298340257, 'a1': 0.7817207751748885, 'a2': 0.9173797470150565, 'a3': 0.9585698927016494})
#metric-0:  {'abs_rel': 0.1370048491627752, 'sq_rel': 2.210344564156099, 'rms': 11.637852490412724, 'log_rms': 0.2088111490843358, 'a1': 0.852483247998473, 'a2': 0.9552432247880217, 'a3': 0.9806259791417555}
#median-0:  {'abs_rel': 0.1274264622305508, 'sq_rel': 2.1413127163749235, 'rms': 11.848537564896917, 'log_rms': 0.20694463007442362, 'a1': 0.8550992254854797, 'a2': 0.9545830361564438, 'a3': 0.980202404059373}
#metric-1:  {'abs_rel': 0.1844335233100823, 'sq_rel': 2.487485845476002, 'rms': 10.584751849917623, 'log_rms': 0.27735537994411086, 'a1': 0.7784366488611544, 'a2': 0.9136819356447691, 'a3': 0.9567836115577004}
#median-1:  {'abs_rel': 0.18091952312108758, 'sq_rel': 2.445378469143595, 'rms': 10.705362067578674, 'log_rms': 0.2766509678766325, 'a1': 0.7691843369312875, 'a2': 0.9129555249678624, 'a3': 0.9566504069891842}
#metric-2:  {'abs_rel': 0.1935598928665186, 'sq_rel': 2.8596844265967993, 'rms': 10.06006094339606, 'log_rms': 0.2948365968678679, 'a1': 0.7590894273426626, 'a2': 0.9069604332725723, 'a3': 0.9515499554826068}
#median-2:  {'abs_rel': 0.19007227056405762, 'sq_rel': 2.745637713388673, 'rms': 10.101090959713057, 'log_rms': 0.2907295131857519, 'a1': 0.7656302411931676, 'a2': 0.9081443780815447, 'a3': 0.9523901415645302}
#metric-3:  {'abs_rel': 0.19366921511563387, 'sq_rel': 2.6294926874281526, 'rms': 10.300278366432561, 'log_rms': 0.28950088063424284, 'a1': 0.7586531832194947, 'a2': 0.9039069416306236, 'a3': 0.9505632250649588}
#median-3:  {'abs_rel': 0.18623855802919959, 'sq_rel': 2.6098951439588487, 'rms': 10.32259408665942, 'log_rms': 0.28328062042690716, 'a1': 0.7650221503226013, 'a2': 0.9057098879442587, 'a3': 0.9525233491674646}
#metric-4:  {'abs_rel': 0.21764650625551676, 'sq_rel': 3.152245843429844, 'rms': 9.851906278535917, 'log_rms': 0.3132338256069592, 'a1': 0.7258231344122391, 'a2': 0.8933954315139102, 'a3': 0.9442972913036098}
#median-4:  {'abs_rel': 0.2066769263274097, 'sq_rel': 2.9958026342926085, 'rms': 9.941058020947816, 'log_rms': 0.3075616801114051, 'a1': 0.7410693387203402, 'a2': 0.8949901851179538, 'a3': 0.9440350725047}
#metric-5:  {'abs_rel': 0.16401249378048754, 'sq_rel': 2.769608973647867, 'rms': 12.415105925721008, 'log_rms': 0.2613486233140741, 'a1': 0.7966978506608443, 'a2': 0.9247312001438884, 'a3': 0.9638699016478155}
#median-5:  {'abs_rel': 0.16571895855491037, 'sq_rel': 2.7622659633956945, 'rms': 12.4172056006766, 'log_rms': 0.25826356627434105, 'a1': 0.7943193571753316, 'a2': 0.927895467993501, 'a3': 0.965617987350984}

  load_weights_dir: './results_ab/viv/vic_vf_fusion_time_4/survf_fusion/models/weights_4e_1995b'


  models_to_load: ['depth_estimation_net','pose_estimation_net']
  
logging:
  early_phase: 2000
  log_frequency: 1000
  early_log_frequency: 100
  late_log_frequency: 1000
  save_frequency: 1
  board_pth: './board/Viv_vox_ddp_t3/log'
